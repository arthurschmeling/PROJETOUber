<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Parte L√≥gica - Como funciona o Uber?</title>
</head>

<body>
    <header class="hero">
        <div class="container">
            <div class="header-logo">
                <img src="assets/img/cuber.png" alt="cuBer Logo" class="logo-img">
            </div>
            <h1>Parte L√≥gica do Uber</h1>
            <p class="lead">Uma vis√£o clara e did√°tica das decis√µes t√©cnicas, algoritmos e arquitetura por tr√°s de uma plataforma de mobilidade.</p>

            <nav class="main-nav" aria-label="Navega√ß√£o principal">
        <a href="index.html" class="nav-btn">In√≠cio</a>
                <a href="detalhes.html" class="nav-btn">Entenda como funciona</a>
                <a href="parte-logica.html" class="nav-btn active">Parte l√≥gica</a>
                <a href="sobreNos.html" class="nav-btn active">Criadores do site</a>
            </nav>

            <div class="hero-features" style="margin-top:18px">
                <div class="feature feature-interactive">
                    <div class="icon">üõ∞Ô∏è</div>
                    <div>
                        <h4>Geolocaliza√ß√£o</h4>
                        <p class="muted">Rastreamento em tempo real e posicionamento do motorista e passageiro.</p>
                    </div>
                </div>
                <div class="feature feature-interactive">
                    <div class="icon">üß†</div>
                    <div>
                        <h4>Algoritmos</h4>
                        <p class="muted">Roteamento, matchmaking e estimativas com ML e otimiza√ß√£o.</p>
                    </div>
                </div>
                <div class="feature feature-interactive">
                    <div class="icon">‚öôÔ∏è</div>
                    <div>
                        <h4>Infraestrutura</h4>
                        <p class="muted">Servidores, filas, toler√¢ncia a falhas e escalabilidade.</p>
                    </div>
                </div>
            </div>

            <div class="cta-row" style="margin-top:20px">
                <a class="btn" href="simulacao.html">Fazer uma simula√ß√£o</a>
                <a class="btn secondary" href="index.html">Voltar ao in√≠cio</a>
            </div>
        </div>
    </header>

    <main class="container">
        <section class="intro-section">
            <div class="intro-content">
                <h2>Como a parte l√≥gica conecta passageiros e motoristas</h2>
                <p class="muted">A plataforma integra v√°rios subsistemas: captura de localiza√ß√£o, c√°lculo de rotas, sele√ß√£o e ordena√ß√£o de motoristas, c√°lculo de pre√ßos, processamento de pagamentos, e monitoramento. Aqui est√° uma explica√ß√£o organizada para entender cada pe√ßa.</p>

                <div class="quick-stats" style="margin-top:20px">
                    <div class="stat-box">
                        <span class="stat-value">10ms</span>
                        <span class="stat-name">Lat√™ncia t√≠pica (API interna)</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-value">+100k</span>
                        <span class="stat-name">Eventos por minuto</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-value">N/A</span>
                        <span class="stat-name">Roteamento em tempo real</span>
                    </div>
                </div>
            </div>

            <aside class="intro-visual">
                <div class="preview">
                    <div class="preview-inner">
                        <img id="previewImg" src="assets/img/banco.png" alt="Diagrama de banco de dados" class="preview-img" role="button" tabindex="0" aria-label="Ampliar diagrama"/>
                        <p class="muted" style="margin-top:8px;font-size:0.9rem">Exemplo simplificado: entidades Usu√°rio e Viagem.</p>
                        <img src="assets/img/fluxograma.png" alt="Fluxograma do processamento" class="preview-img">
                    </div>
                </div>
            </aside>
        </section>

        <section class="topics-section">
            <h2>T√≥picos principais</h2>
            <div class="topics-grid" style="margin-top:20px">
                <article class="topic-card">
                    <span class="topic-icon">üó∫Ô∏è</span>
                    <h3>Geocoding & Mapeamento</h3>
                    <p class="muted">Convers√£o de endere√ßos em coordenadas (geocoding), integra√ß√£o com provedores de mapas e servi√ßos de roteamento para estimar dist√¢ncia e tempo.</p>
                    <a class="topic-link" href="#">Ver detalhes</a>
                </article>

                <article class="topic-card">
                    <span class="topic-icon">üîÅ</span>
                    <h3>Matchmaking (pareamento)</h3>
                    <p class="muted">Algoritmos que escolhem o motorista ideal para cada requisi√ß√£o considerando proximidade, tempo de chegada, aceita√ß√£o, e regras de prioridade.</p>
                    <a class="topic-link" href="#matchmaking">Ver algoritmo</a>
                </article>

                                <article class="topic-card">
                                        <span class="topic-icon">üìà</span>
                                        <h3>Precifica√ß√£o</h3>
                                        <p class="muted">Modelo h√≠brido com tarifa base + por km e multiplicadores (demanda, clima, tr√¢nsito, hor√°rio).</p>
                                        <pre class="formula-box" style="margin-top:12px"><code>// c√°lculo simplificado de pre√ßo (em Reais)
const precoBase = 5.00;
const precoPorKm = 1.80; // exemplo
function calcularPreco(distanciaKm, multiplicadorTotal){
    const subtotal = precoBase + precoPorKm * distanciaKm;
    return (subtotal * multiplicadorTotal).toFixed(2);
}
</code></pre>
                                        <a class="topic-link" href="simulacao.html">Simular pre√ßo</a>
                                </article>

                <article class="topic-card">
                    <span class="topic-icon">‚òÅÔ∏è</span>
                    <h3>Escalabilidade & Resili√™ncia</h3>
                    <p class="muted">Arquitetura baseada em microsservi√ßos, filas, caches e sharding para suportar alto volume com baixa lat√™ncia.</p>
                    <a class="topic-link" href="#scaling">Estrat√©gias</a>
                </article>
            </div>
        </section>

        <section id="matchmaking" style="margin-top:40px">
            <h2>Matchmaking ‚Äî como o sistema escolhe um motorista</h2>
            <div class="card card-body" style="margin-top:12px">
                <p class="muted">Quando um passageiro solicita uma corrida, o sistema executa passos curtos e r√°pidos:</p>
                <ol style="margin-top:12px">
                    <li>Coleta: recebe origem/destino e localiza√ß√£o atual do passageiro.</li>
                    <li>Filtragem: identifica motoristas eleg√≠veis (dispon√≠veis, no raio definido, compat√≠veis).</li>
                    <li>Ordena√ß√£o: calcula m√©tricas (ETA, custo, hist√≥rico) e ordena candidatos.</li>
                    <li>Oferta: envia proposta sequencial ou em lote para motoristas, aguardando aceita√ß√£o.</li>
                </ol>
                <p class="muted">Esse fluxo precisa ser r√°pido (ms‚Äìs) e tolerante a falhas: se n√£o houver resposta, o sistema tenta o pr√≥ximo candidato.</p>

                <pre class="formula-box" style="margin-top:12px"><code>/* Pseudoc√≥digo: selecionar o melhor motorista */
function findDriver(request, drivers) {
    // filtra motoristas dispon√≠veis num raio
    const candidates = drivers.filter(d =&gt; d.available &amp;&amp; distance(d.pos, request.pos) &lt; MAX_RADIUS);
    // ordena por ETA estimado (ou outra m√©trica composta)
    candidates.sort((a, b) =&gt; ETA(a, request) - ETA(b, request));
    // retorna o primeiro candidato (ou uma lista para oferta em lote)
    return candidates[0];
}
</code></pre>
            </div>
        </section>

        <section id="routing" style="margin-top:32px">
            <h2>Roteamento e estimativas</h2>
            <div class="card card-body" style="margin-top:12px">
                <p class="muted">Roteadores (como OSRM, GraphHopper ou solu√ß√µes internas) devolvem trajetos e tempos estimados. Para melhorar estimativas o sistema aplica:</p>
                <ul style="margin-top:12px">
                    <li>Dados hist√≥ricos de velocidade por trecho e hora do dia;</li>
                    <li>Corre√ß√µes por tr√¢nsito em tempo real;</li>
                    <li>L√≥gica para replanos durante a corrida (desvios/obras).</li>
                </ul>
                                <pre class="formula-box" style="margin-top:12px"><code>// Exemplo: chamada simples ao OSRM para obter dist√¢ncia
fetch(`https://router.project-osrm.org/route/v1/driving/${lon1},${lat1};${lon2},${lat2}?overview=false`)
    .then(res =&gt; res.json())
    .then(data =&gt; {
        const route = data.routes &amp;&amp; data.routes[0];
        const distanciaMetros = route ? route.distance : 0;
        const duracaoSegundos = route ? route.duration : 0;
        // converter e usar nos c√°lculos
    });
</code></pre>
            </div>
        </section>

        <section id="data-model" style="margin-top:32px">
            <h2>Modelo de dados (simplificado)</h2>
            <div class="card card-body" style="display:flex;flex-direction:column;gap:12px;margin-top:12px">
                <p class="muted">Entidades principais:</p>
                <ul>
                    <li><strong>Usu√°rio</strong>: id, nome, rating, formaPagamento;</li>
                    <li><strong>Motorista</strong>: id, localiza√ß√£o atual, status, hist√≥rico;</li>
                    <li><strong>Viagem</strong>: origem, destino, dist√¢ncia, dura√ß√£o, pre√ßo, timestamps;</li>
                </ul>
                                <pre class="formula-box" style="margin-top:8px"><code>-- Exemplo simples de esquema SQL
CREATE TABLE usuario (
    id SERIAL PRIMARY KEY,
    nome VARCHAR(120) NOT NULL,
    rating NUMERIC(2,1),
    forma_pagamento VARCHAR(40)
);

CREATE TABLE viagem (
    id SERIAL PRIMARY KEY,
    usuario_id INT REFERENCES usuario(id),
    origem GEOMETRY(POINT),
    destino GEOMETRY(POINT),
    distancia_km NUMERIC,
    duracao_min INT,
    preco NUMERIC(8,2),
    created_at TIMESTAMP DEFAULT now()
);
</code></pre>
                                <p class="muted">Normalmente, combina-se um banco relacional para persist√™ncia das viagens com bancos NoSQL para leitura de alta velocidade e caches para consultas frequentes.</p>
            </div>
        </section>

        <section id="privacy" style="margin-top:32px">
            <h2>Privacidade e Seguran√ßa</h2>
            <div class="card card-body" style="margin-top:12px">
                <p class="muted">Algumas pr√°ticas importantes:</p>
                <ul>
                    <li>Criptografia de dados sens√≠veis em tr√¢nsito e em repouso;</li>
                    <li>Controle de acesso estrito (roles, logs de auditoria);</li>
                    <li>Minimiza√ß√£o de dados: armazenar apenas o necess√°rio e por tempo limitado.</li>
                </ul>
            </div>
        </section>

        <section id="scaling" style="margin-top:32px">
            <h2>Escalabilidade e monitoramento</h2>
            <div class="card card-body" style="margin-top:12px">
                <p class="muted">Para manter o servi√ßo est√°vel em picos:</p>
                <ul>
                    <li>Use filas para desacoplar produtores e consumidores (ex.: Kafka, RabbitMQ);</li>
                    <li>Autoscaling e replica√ß√£o de servi√ßos cr√≠ticos;</li>
                    <li>Monitoramento com m√©tricas (lat√™ncia, erros) e alertas autom√°ticos.</li>
                </ul>
            </div>
        </section>

        <section class="exemplo-section" style="margin-top:40px">
            <h2>Exemplo pr√°tico: banco de dados (diagrama)</h2>
            <div class="exemplo-box" style="margin-top:12px">
                <div class="exemplo-item">
                    <div class="exemplo-label">Usu√°rio</div>
                    <div class="exemplo-valor">id, nome, rating, pagamento</div>
                </div>
                <div class="exemplo-item">
                    <div class="exemplo-label">Viagem</div>
                    <div class="exemplo-valor">origem, destino, dist√¢ncia, pre√ßo</div>
                </div>
                <div class="exemplo-item exemplo-final">
                    <div class="exemplo-label">Relacionamento</div>
                    <div class="exemplo-valor">Usu√°rio 1:N Viagem</div>
                </div>
            </div>
        </section>

                <footer class="site-footer" style="margin-top:48px">
                        <div class="container">&copy; 2025 ‚Äî Explica√ß√£o did√°tica sobre a parte l√≥gica do Uber. <a href="index.html" class="nav-btn" style="margin-left:12px;padding:6px 10px">Voltar</a></div>
                </footer>
        </main>

        <!-- Image modal / lightbox (abre ao clicar em qualquer .preview-img) -->
        <div id="imgModal" class="img-modal-overlay" aria-hidden="true">
                <div class="img-modal-wrap" role="dialog" aria-modal="true" aria-label="Imagem ampliada">
                        <button id="imgModalClose" class="img-modal-close" aria-label="Fechar">‚úï</button>
                        <img id="imgModalImg" src="" alt="Diagrama ampliado" />
                </div>
        </div>

        <script>
        (function(){
            const previews = Array.from(document.querySelectorAll('.preview-img'));
            const modal = document.getElementById('imgModal');
            const modalImg = document.getElementById('imgModalImg');
            const closeBtn = document.getElementById('imgModalClose');

            if(!modal || previews.length === 0) return;

            function openModalWith(src, alt){
                modalImg.src = src;
                modalImg.alt = alt || '';
                modal.classList.add('active');
                modal.setAttribute('aria-hidden','false');
                closeBtn.focus();
                document.body.style.overflow = 'hidden';
            }

            function closeModal(){
                modal.classList.remove('active');
                modal.setAttribute('aria-hidden','true');
                modalImg.src = '';
                document.body.style.overflow = '';
            }

            previews.forEach(img => {
                img.style.cursor = 'zoom-in';
                img.addEventListener('click', () => openModalWith(img.src, img.alt));
                img.addEventListener('keypress', (e) => { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); openModalWith(img.src, img.alt); }});
            });

            closeBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', function(e){ if(e.target === modal) closeModal(); });
            document.addEventListener('keydown', function(e){ if(e.key === 'Escape' && modal.classList.contains('active')) closeModal(); });
        })();
        </script>

</body>

</html>